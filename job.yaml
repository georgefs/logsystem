env: ## require
    GLIACLOUD_CLUSTER: web
    GLIACLOUD_PROJECT: test
    GLIACLOUD_HOSTNAME:    %(hostname)s
    GLIACLOUD_TYPE:    job

rsyslog: ## custom
    path: /etc/rsyslog.d/gliacloud.conf
    config: | 
        set $!gliacloud!entity!msg = $msg;
        set $!gliacloud!entity!project = "{{env[GLIACLOUD_PROJECT]}}";
        set $!gliacloud!entity!cluster = "{{env[GLIACLOUD_CLUSTER]}}";
        set $!gliacloud!entity!hostname = $source;
        set $!gliacloud!entity!tag = $syslogtag;
        set $!gliacloud!entity!type = "{{env[GLIACLOUD_TYPE]}}";
        set $!gliacloud!entity!application = $app-name;
        set $!gliacloud!entity!input = $inputname;
        set $!gliacloud!entity!time = $timegenerated;

        template(name="gliacloud_tpl" type="subtree" subtree="$!gliacloud!entity")
        *.*     /tmp/rsyslog;gliacloud_tpl
    setup: rsyslogd


